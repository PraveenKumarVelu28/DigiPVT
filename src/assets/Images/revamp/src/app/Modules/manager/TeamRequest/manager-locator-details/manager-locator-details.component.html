<app-commonalertpage [messageId]="messageId" *ngIf="showPopup==1"></app-commonalertpage>
<app-loader *ngIf="loader"></app-loader>
<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            <div class="row">
                <div class="col-md-8">
                    <ul>
                        <li *ngIf="roleid!=11"><a class="active Heading" routerLink="/Employee/LocatorDashboard"> My
                                Locator Details</a>
                        </li>
                        <li *ngIf="roleid==2"><a class="leavelist Heading"
                                routerLink="/Manager/ManagerLocatorDetails"><u>My Team Locator Details</u></a>
                        </li>
                        <li *ngIf="roleid==1 ||roleid==9 ||roleid==11 ||roleid==10"><a class="leavelist Heading"
                                routerLink="/ManagerLocatorDetails"><u>Company Locator
                                    Details</u></a>
                        </li>
                    </ul>
                </div>
                <div class="col-md-4"></div>
            </div>
            <br>
            <div class="card filtercard">
                <div class="row">
                    <div class="col-md-1">
                        <img src="assets/Images/filter.svg" class="filter-img">
                        <p class="filter">Filter By:</p>
                    </div>
                    <div class="col-md-2">
                        From Date
                        <input class="form-control" type="date" id="date" name="date" [(ngModel)]="date"
                            placeholder="Duration">
                    </div>
                    <div class="col-md-2">
                        To Date
                        <input class="form-control" type="date" id="edate" name="edate" [(ngModel)]="edate"
                            placeholder="Duration" (change)="Getedate()">
                    </div>
                    <div class="col-md-6">
                        <br>
                        <input class="form-control" id="term" name="term" [(ngModel)]="term" type="search"
                            placeholder="Search for Date and Staff">
                    </div>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-md-10">
                </div>
                <div class="col-md-2">
                    <a><button *ngIf="selecallbtn" class="form-control button" (click)="Approveall()">Approve
                            Selected</button></a>
                </div>
            </div><br>
            <div class="row">
                <br />
                <div class="col-lg-12 dashbutton bttn">
                    <div class="tab-slider--nav">
                        <ul class="tab-slider--tabs">
                            <li class="tab-slider--trigger" [class.active]="viewMode == 'tab1'" rel="tab1"
                                (click)="viewMode ='tab1'">
                                Pending</li>
                            <li class="tab-slider--trigger" [class.active]="viewMode == 'tab2'" rel="tab2"
                                (click)="viewMode ='tab2'">Approved</li>
                            <li class="tab-slider--trigger" [class.active]="viewMode == 'tab3'" rel="tab3"
                                (click)="viewMode ='tab3'">Rejected</li>
                        </ul>
                    </div>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="tab-slider--container" [ngSwitch]="viewMode">
                    <div *ngSwitchCase="'tab1'" id="tab1">
                        <div class="row">
                            <div class="col-md-10">
                                <p class="show3res">SHOWING <span>{{locatorlist1?.length}}</span> RESULTS</p>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="container-fluid">
                                <!-- <table class="table table-bordered"> -->
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th *ngIf="roleid==2">Select All <input type="checkbox" name="select-all"
                                                    id="select-all" (click)="selectALL(true)" /></th>
                                            <th>Employee Name</th>
                                            <th class="col-md-1">Date</th>
                                            <th class="col-md-2">Purpose</th>
                                            <th>Time of Departure</th>
                                            <th>Time of Return</th>
                                            <th>Destination</th>
                                            <th>No of Hours(HH:MM)</th>
                                            <th>Attachment</th>
                                            <th *ngIf="roleid==2">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let locator of locatorlist1|filter:term">
                                            <td *ngIf="roleid==2"><input *ngIf="locator.approveStatus==null"
                                                    type="checkbox" (click)="getCheckbocdetails(locator)">
                                            </td>
                                            <td>{{locator.staffname}}</td>
                                            <td class="col-md-1">{{locator.date|date}}</td>
                                            <td class="col-md-2">{{locator.purpose}}</td>
                                            <td>{{locator.timeOfDeparture}}</td>
                                            <td>{{locator.timeOfReturn}}</td>
                                            <td>{{locator.destination}}</td>
                                            <td>{{locator.hourDiff|date:"HH:mm"}}</td>
                                            <td>
                                                <img src="assets/Images/image.png" style="width:20px; height:20px"
                                                    (click)="image(locator.id)" data-toggle="modal"
                                                    data-target="#exampleModal1">
                                            </td>
                                            <td *ngIf="roleid==2"><img *ngIf="locator.approveStatus==null" class="img"
                                                    src="assets/Images/check-mark.png"
                                                    (click)="AcceptLocatorRequest(locator)">
                                                <img *ngIf="locator.approveStatus==null" class="imgcancel"
                                                    src="assets/Images/cancel (1).png" (click)="getid(locator.id)"
                                                    data-toggle="modal" data-target="#Reject">
                                                <p *ngIf="locator.approveStatus=='Approved'">Approved</p>
                                                <p *ngIf="locator.approveStatus=='Rejected'">Rejected</p>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div *ngSwitchCase="'tab2'" id="tab2">
                        <div class="row">
                            <div class="col-md-10">
                                <br>
                                <p class="show3res">SHOWING <span>{{locatorlist2?.length}}</span> RESULTS</p>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="container-fluid">
                                <table class="table table-bordered">
                                    <thead>
                                        <tr>
                                            <th>Employee Name</th>
                                            <th>Date</th>
                                            <th>Purpose</th>
                                            <th>Time of Departure</th>
                                            <th>Time of Return</th>
                                            <th>Destination</th>
                                            <th>No of Hours</th>
                                            <th *ngIf="login!=1">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let locator of locatorlist2|filter:term">
                                            <td>{{locator.staffname}}</td>
                                            <td>{{locator.date|date}}</td>
                                            <td>{{locator.purpose}}</td>
                                            <td>{{locator.timeOfDeparture}}</td>
                                            <td>{{locator.timeOfReturn}}</td>
                                            <td>{{locator.destination}}</td>
                                            <td>{{locator.hourDiff|date:"HH:mm"}}</td>
                                            <td *ngIf="login!=1"><img *ngIf="locator.approveStatus==null" class="img"
                                                    src="assets/Images/check-mark.png"
                                                    (click)="AcceptLocatorRequest(locator)">
                                                <img *ngIf="locator.approveStatus==null" class="imgcancel"
                                                    src="assets/Images/cancel (1).png" (click)="getid(locator.id)"
                                                    data-toggle="modal" data-target="#Reject">
                                                <p *ngIf="locator.approveStatus=='Approved'">Approved</p>
                                                <p *ngIf="locator.approveStatus=='Rejected'">Rejected</p>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div *ngSwitchCase="'tab3'" id="tab3">
                        <div class="row">
                            <div class="col-md-10">
                                <p class="show3res">SHOWING <span>{{locatorlist3?.length}}</span> RESULTS</p>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="container-fluid">
                                <table class="table table-bordered">
                                    <thead>
                                        <tr>
                                            <th>Employee Name</th>
                                            <th>Date</th>
                                            <th>Purpose</th>
                                            <th>Time of Departure</th>
                                            <th>Time of Return</th>
                                            <th>Destination</th>
                                            <th>No of Hours</th>
                                            <th *ngIf="login!=1">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let locator of locatorlist3|filter:term">
                                            <td>{{locator.staffname}}</td>
                                            <td>{{locator.date|date}}</td>
                                            <td>{{locator.purpose}}</td>
                                            <td>{{locator.timeOfDeparture}}</td>
                                            <td>{{locator.timeOfReturn}}</td>
                                            <td>{{locator.destination}}</td>
                                            <td>{{locator.hourDiff|date:"HH:mm"}}</td>
                                            <td *ngIf="login!=1"><img *ngIf="locator.approveStatus==null" class="img"
                                                    src="assets/Images/check-mark.png"
                                                    (click)="AcceptLocatorRequest(locator)">
                                                <img *ngIf="locator.approveStatus==null" class="imgcancel"
                                                    src="assets/Images/cancel (1).png" (click)="getid(locator.id)"
                                                    data-toggle="modal" data-target="#Reject">
                                                <p *ngIf="locator.approveStatus=='Approved'">Approved</p>
                                                <p *ngIf="locator.approveStatus=='Rejected'">Rejected</p>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-1"></div>
            </div>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
        </div>
        <div id="Reject" class="modal fade" role="dialog">
            <div class="modal-dialog modal-lg">
                <div class="modal-content ">
                    <div class="modal-header">
                        <div class="row">
                            <div class="col-lg-8">
                                <h5>Reject Notes</h5>
                            </div>
                        </div>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>
                    <div class="modal-body ">
                        <div class="container-fluid">
                            <div class="row centeralign">
                                <div class="col-lg-3">
                                    Notes
                                </div>
                                <div class="col-lg-7">
                                    <textarea rows="3" type="text" [(ngModel)]="Notes" id="Notes" name="Notes"
                                        placeholder="Notes"></textarea>
                                </div>
                            </div>
                            <br />
                            <div class="row centeralign">
                                <div class="col-lg-4">
                                </div>
                                <div class="col-lg-5">
                                    <button class="upload" (click)="RejectLocatorRequest()">Submit</button>
                                </div>
                            </div>
                            <br />
                        </div>
                        <div class="modal-footer">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="exampleModal1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel1"
            aria-hidden="true">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Related Attachments</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-lg-4" *ngFor="let details of multipleattachmentlist">
                                <div class="row">
                                    <div class="col-lg-10">
                                        <!-- <a href="{{details.attachment}}" target="_blank">
                                        <img style="width:100%;height:auto;" src="{{details.attachment}}">
                                      </a> -->
                                        <img src="{{details.attachment}}" *ngIf="details.filetype=='Image'"
                                            (click)="openAttchments(details.attachment)"
                                            style="width: 171px; height: 117px;">

                                        <img src="assets/Images/pdf.png" *ngIf="details.filetype=='Pdf'"
                                            (click)="openAttchments(details.attachment)"
                                            style="width: 171px; height: 117px;">
                                        <img src="assets/Images/word.png" *ngIf="details.filetype=='Document'"
                                            (click)="openAttchments(details.attachment)"
                                            style="width: 171px; height: 117px;">
                                        <img src="assets/Images/files.png" *ngIf="details.filetype=='Ppt'"
                                            (click)="openAttchments(details.attachment)"
                                            style="width: 171px; height: 117px;">
                                    </div>
                                </div>
                            </div>
                            <br>
                        </div>
                        <br>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="cancel" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>